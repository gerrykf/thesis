# H5移动端设计方案 (375px居中适配)

## 1. 前台H5设计理念

### 1.1 设计规范
- **设计尺寸**: 375px宽度 (iPhone X标准)
- **PC端展示**: 375px容器居中显示，两侧留白
- **移动端展示**: 全屏响应式适配
- **UI框架**: Vant4 (专为移动端优化)

### 1.2 响应式策略 (PostCSS自动px转rem)
```css
/* 开发时直接写px，PostCSS自动转换为rem */
.app-container {
  max-width: 375px;        /* → 自动转换为 23.4375rem */
  margin: 0 auto;
  min-height: 100vh;
  background: #fff;
  box-shadow: 0 0 20px rgba(0,0,0,0.1); /* → 自动转换为 1.25rem */
}

/* 移动端适配 */
@media (max-width: 768px) {
  .app-container {
    max-width: 100%;
    box-shadow: none;
  }
}

/* rem基准通过JS动态设置，这里只是示例 */
html {
  font-size: 16px; /* 默认基准字体大小，会被JS动态调整 */
}
```

**PostCSS转换示例**:
```css
/* 开发时编写 ↓ */
.header {
  height: 44px;
  padding: 16px;
  font-size: 18px;
}

/* PostCSS自动转换为 ↓ */
.header {
  height: 2.75rem;   /* 44px ÷ 16 */
  padding: 1rem;     /* 16px ÷ 16 */
  font-size: 1.125rem; /* 18px ÷ 16 */
}
```

## 2. H5前台页面设计

### 2.1 页面布局结构
```
┌─────────────────┐ 375px
│   状态栏区域     │
├─────────────────┤
│   顶部导航栏     │ 44px
├─────────────────┤
│                │
│   内容区域       │ flex: 1
│                │
├─────────────────┤
│   底部导航栏     │ 50px
└─────────────────┘
```

### 2.2 核心页面设计

**首页 (今日概览)**
```
┌─────────────────┐
│ 👋 你好，XXX     │
├─────────────────┤
│ 📊 今日数据      │
│ ┌─────┬─────┐   │
│ │体重  │运动  │   │
│ │65kg │30min│   │
│ └─────┴─────┘   │
│ ┌─────┬─────┐   │
│ │睡眠  │卡路里│   │
│ │8h   │1200 │   │
│ └─────┴─────┘   │
├─────────────────┤
│ 🎯 快捷操作      │
│ [健康打卡][饮食记录]│
└─────────────────┘
```

**健康打卡页面**
```
┌─────────────────┐
│ ← 健康打卡       │
├─────────────────┤
│ 📅 2024-01-15   │
├─────────────────┤
│ 体重 (kg)        │
│ [    65.5    ]  │
├─────────────────┤
│ 运动时长 (分钟)   │
│ [     30     ]  │
├─────────────────┤
│ 睡眠时长 (小时)   │
│ [     8      ]  │
├─────────────────┤
│ 备注             │
│ [今天感觉不错...] │
├─────────────────┤
│   [保存打卡]     │
└─────────────────┘
```

**饮食记录页面**
```
┌─────────────────┐
│ ← 饮食记录       │
├─────────────────┤
│ 📅 选择日期      │
│ [2024-01-15] 🗓️ │
├─────────────────┤
│ 🌅 早餐 (320卡) │
│ • 牛奶 250ml    │
│ • 全麦面包 2片   │
│ [+ 添加食物]     │
├─────────────────┤
│ 🌞 午餐 (0卡)   │
│ [+ 添加食物]     │
├─────────────────┤
│ 🌙 晚餐 (0卡)   │
│ [+ 添加食物]     │
├─────────────────┤
│ 今日总计: 320/1500卡│
└─────────────────┘
```

### 2.3 Vant组件使用规划

**核心组件清单**:
```javascript
// 布局组件
- van-nav-bar      // 顶部导航
- van-tabbar       // 底部导航
- van-grid         // 宫格布局

// 表单组件
- van-form         // 表单容器
- van-field        // 输入框
- van-stepper      // 步进器
- van-picker       // 选择器
- van-calendar     // 日历

// 展示组件
- van-card         // 卡片
- van-list         // 列表
- van-cell         // 单元格
- van-progress     // 进度条

// 反馈组件
- van-toast        // 轻提示
- van-dialog       // 弹框
- van-loading      // 加载
```

## 3. CSS样式规范

### 3.1 设计变量 (直接使用px，自动转换)
```css
:root {
  /* 颜色系统 */
  --primary-color: #1989fa;
  --success-color: #07c160;
  --warning-color: #ff976a;
  --danger-color: #ee0a24;
  --text-color: #323233;
  --text-color-2: #646566;
  --background-color: #f7f8fa;
  --white: #ffffff;

  /* 间距系统 (PostCSS自动转换为rem) */
  --space-xs: 8px;    /* → 0.5rem */
  --space-sm: 12px;   /* → 0.75rem */
  --space-md: 16px;   /* → 1rem */
  --space-lg: 24px;   /* → 1.5rem */
  --space-xl: 32px;   /* → 2rem */

  /* 字体系统 (PostCSS自动转换为rem) */
  --font-size-xs: 10px;   /* → 0.625rem */
  --font-size-sm: 12px;   /* → 0.75rem */
  --font-size-md: 14px;   /* → 0.875rem */
  --font-size-lg: 16px;   /* → 1rem */
  --font-size-xl: 18px;   /* → 1.125rem */

  /* 圆角系统 (PostCSS自动转换为rem) */
  --radius-xs: 4px;   /* → 0.25rem */
  --radius-sm: 8px;   /* → 0.5rem */
  --radius-md: 12px;  /* → 0.75rem */
  --radius-lg: 16px;  /* → 1rem */
}
```

### 3.2 布局样式 (开发时写px，自动转rem)
```css
/* 全局容器 - 开发时直接写px */
.app {
  max-width: 375px;     /* PostCSS → 23.4375rem */
  margin: 0 auto;
  min-height: 100vh;
  background: var(--white);
  position: relative;
}

/* PC端居中效果 */
@media (min-width: 769px) {
  .app {
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.1);  /* PostCSS → 1.875rem */
    border-radius: 8px;     /* PostCSS → 0.5rem */
    overflow: hidden;
    margin-top: 20px;       /* PostCSS → 1.25rem */
    margin-bottom: 20px;    /* PostCSS → 1.25rem */
    min-height: calc(100vh - 40px); /* PostCSS → calc(100vh - 2.5rem) */
  }

  body {
    background: #f5f5f5;
  }
}

/* 内容区域 */
.content {
  padding: 0 16px;        /* PostCSS → 0 1rem */
  padding-bottom: 60px;   /* PostCSS → 3.75rem (底部导航高度) */
}

/* 卡片样式 */
.data-card {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: 12px;    /* PostCSS → 0.75rem */
  padding: 20px;          /* PostCSS → 1.25rem */
  margin: 16px 0;         /* PostCSS → 1rem 0 */
  color: white;
}

/* 统计格子 */
.stats-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;              /* PostCSS → 0.75rem */
  margin: 16px 0;         /* PostCSS → 1rem 0 */
}

.stats-item {
  background: white;
  border-radius: 8px;     /* PostCSS → 0.5rem */
  padding: 16px;          /* PostCSS → 1rem */
  text-align: center;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1); /* PostCSS → 0 0.125rem 0.5rem */
}
```

## 4. 技术实现方案

### 4.1 Vue3 + Vant项目配置

**package.json依赖**:
```json
{
  "dependencies": {
    "vue": "^3.3.0",
    "vue-router": "^4.2.0",
    "pinia": "^2.1.0",
    "vant": "^4.8.0",
    "axios": "^1.5.0",
    "@vant/touch-emulator": "^1.4.0"
  },
  "devDependencies": {
    "vite": "^4.4.0",
    "@vitejs/plugin-vue": "^4.3.0",
    "autoprefixer": "^10.4.0",
    "postcss": "^8.4.0"
  }
}
```

**vite.config.ts配置** (含PostCSS rem适配):
```typescript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import { resolve } from 'path'
import Components from 'unplugin-vue-components/vite'
import { VantResolver } from '@vant/auto-import-resolver'
import autoprefixer from 'autoprefixer'
import postcssPxToRem from 'postcss-pxtorem'

export default defineConfig({
  plugins: [
    vue(),
    Components({
      resolvers: [VantResolver()],
    }),
  ],
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src'),
    },
  },
  server: {
    port: 5173,
    host: '0.0.0.0'
  },
  css: {
    postcss: {
      plugins: [
        autoprefixer(),
        postcssPxToRem({
          rootValue: 16, // 根字体大小
          propList: ['*'], // 需要转换的属性
          selectorBlackList: ['.van-'], // 忽略Vant组件
          exclude: /node_modules/i, // 忽略node_modules
          minPixelValue: 2, // 小于2px不转换
          mediaQuery: false, // 不转换媒体查询
          replace: true, // 替换而不是添加备用
        })
      ]
    }
  }
})
```

### 4.2 移动端适配方案 (rem自适应)

**viewport设置**:
```html
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
```

**PostCSS依赖安装**:
```bash
pnpm add -D postcss-pxtorem autoprefixer
```

**rem自适应脚本** (src/utils/flexible.ts):
```typescript
// 移动端rem适配方案
export function setRem(): void {
  const baseSize = 16 // 设计稿基准字体大小
  const designWidth = 375 // 设计稿宽度
  const deviceWidth = document.documentElement.clientWidth || window.innerWidth

  // 计算缩放比例，最大不超过设计稿尺寸
  const scale = Math.min(deviceWidth / designWidth, 1)

  // 设置根字体大小
  const rootFontSize = baseSize * scale
  document.documentElement.style.fontSize = rootFontSize + 'px'

  // 设置body字体大小为14px，避免继承问题
  document.body.style.fontSize = '0.875rem'
}

// 防抖函数
function debounce(func: Function, wait: number) {
  let timeout: NodeJS.Timeout
  return function executedFunction(...args: any[]) {
    const later = () => {
      clearTimeout(timeout)
      func.apply(this, args)
    }
    clearTimeout(timeout)
    timeout = setTimeout(later, wait)
  }
}

// 初始化和监听窗口变化
export function initFlexible(): void {
  setRem()

  // 监听窗口大小变化
  const debouncedSetRem = debounce(setRem, 100)
  window.addEventListener('resize', debouncedSetRem)
  window.addEventListener('orientationchange', debouncedSetRem)

  // 监听字体大小变化
  window.addEventListener('pageshow', (e) => {
    if (e.persisted) {
      setRem()
    }
  })
}
```

**在main.ts中引入**:
```typescript
import { createApp } from 'vue'
import App from './App.vue'
import { initFlexible } from './utils/flexible'

// 初始化rem适配
initFlexible()

const app = createApp(App)
app.mount('#app')
```

**CSS样式规范** (开发友好的px写法):
```css
/* 开发时完全按照设计稿写px，PostCSS自动处理 */
.page-header {
  height: 44px;       /* → 2.75rem */
  padding: 0 16px;    /* → 0 1rem */
  font-size: 18px;    /* → 1.125rem */
  background: #fff;
  border-bottom: 1px solid #eee; /* 1px不转换 */
}

.card-item {
  width: 335px;          /* → 20.9375rem */
  height: 120px;         /* → 7.5rem */
  margin: 20px auto;     /* → 1.25rem auto */
  padding: 16px;         /* → 1rem */
  border-radius: 12px;   /* → 0.75rem */
  box-shadow: 0 4px 12px rgba(0,0,0,0.1); /* → 0 0.25rem 0.75rem */
}

.form-item {
  margin-bottom: 24px;   /* → 1.5rem */
}

.form-item label {
  font-size: 14px;       /* → 0.875rem */
  margin-bottom: 8px;    /* → 0.5rem */
}

.form-item input {
  height: 48px;          /* → 3rem */
  padding: 0 12px;       /* → 0 0.75rem */
  font-size: 16px;       /* → 1rem */
  border-radius: 6px;    /* → 0.375rem */
}

/* 特殊情况：边框线保持1px不转换 */
.divider {
  border-top: 1px solid #f0f0f0;  /* 1px不会被转换 */
}

/* 组件库样式不受影响 */
.van-button {
  /* Vant组件样式被selectorBlackList排除，不会转换 */
}
```

**实际转换效果对比**:
```css
/* 源码 (你写的) */
.demo {
  width: 300px;
  height: 200px;
  padding: 20px 16px;
  margin-top: 24px;
  font-size: 16px;
  border-radius: 8px;
  border: 1px solid #ccc;
}

/* 编译后 (浏览器看到的) */
.demo {
  width: 18.75rem;      /* 300 ÷ 16 */
  height: 12.5rem;      /* 200 ÷ 16 */
  padding: 1.25rem 1rem; /* 20÷16 16÷16 */
  margin-top: 1.5rem;   /* 24 ÷ 16 */
  font-size: 1rem;      /* 16 ÷ 16 */
  border-radius: 0.5rem; /* 8 ÷ 16 */
  border: 1px solid #ccc; /* 1px保持不变 */
}
```

### 4.3 路由配置
```javascript
// router/index.js
const routes = [
  { path: '/', redirect: '/home' },
  { path: '/home', component: () => import('../views/Home.vue') },
  { path: '/login', component: () => import('../views/Login.vue') },
  { path: '/health', component: () => import('../views/Health.vue') },
  { path: '/diet', component: () => import('../views/Diet.vue') },
  { path: '/history', component: () => import('../views/History.vue') },
  { path: '/profile', component: () => import('../views/Profile.vue') }
]
```

## 5. 开发工具配置

### 5.1 Chrome调试
```javascript
// 开发时模拟移动端
// F12 -> 切换设备工具栏 -> iPhone X (375x812)
```

### 5.2 VS Code插件推荐
- Vetur (Vue语法支持)
- Auto Rename Tag
- Bracket Pair Colorizer
- Live Server

## 6. 性能优化

### 6.1 Vant按需引入
```javascript
// main.js
import { Button, Form, Field, Toast } from 'vant';

app.use(Button);
app.use(Form);
app.use(Field);
app.use(Toast);
```

### 6.2 图片优化
```css
/* 图片懒加载 */
.lazy-image {
  background: #f5f5f5;
  transition: opacity 0.3s;
}

/* WebP格式支持 */
.webp .image {
  background-image: url('image.webp');
}
.no-webp .image {
  background-image: url('image.jpg');
}
```

## 7. 兼容性考虑

### 7.1 浏览器支持
- **移动端**: iOS Safari 10+, Android Chrome 50+
- **PC端**: Chrome 70+, Firefox 65+, Safari 12+

### 7.2 降级方案
```javascript
// 检测移动端
const isMobile = /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

if (isMobile) {
  // 移动端特定逻辑
} else {
  // PC端特定逻辑
}
```

这个设计方案实现了：
1. **移动优先**: 375px标准设计，完美适配主流手机
2. **PC兼容**: 居中显示，保持良好视觉效果
3. **开发高效**: 使用Vant组件库，快速开发
4. **体验一致**: 统一的设计语言和交互模式