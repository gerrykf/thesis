# 双端健康管理系统架构设计 (4周完成)

## 1. 系统架构概述

### 1.1 整体架构
```
移动端用户界面 (Vant) ←→ 后端API (Node.js + Express) ←→ PC端管理界面 (Element Plus)
                                    ↓
                              MySQL数据库
```

### 1.2 技术栈分配
**前台用户端 (移动端)**:
- Vue3 + Vant4 + Axios + Vue Router
- 适配移动端，响应式设计
- PWA支持

**后台管理端 (PC端)**:
- Vue3 + Element Plus + Axios + Vue Router
- 管理员功能，数据管理
- 图表展示

**后端API**:
- Node.js + Express + JWT + MySQL2
- 统一API接口服务两个端

## 2. 功能分配

### 2.1 前台用户端 (Vant) - 用户使用
**核心功能**:
- ✅ 用户注册/登录
- ✅ 健康打卡 (体重/运动/睡眠)
- ✅ 饮食记录 (三餐记录)
- ✅ 个人中心 (资料修改)
- ✅ 历史记录查看

**页面结构**:
```
前台 (8个页面):
├── 登录/注册页
├── 首页 (今日概览)
├── 健康打卡页
├── 饮食记录页
├── 历史记录页
├── 个人中心页
├── 设置页
└── 关于页
```

### 2.2 后台管理端 (Element Plus) - 管理员使用
**核心功能**:
- ✅ 用户管理 (查看/编辑/删除用户)
- ✅ 食物数据库管理 (增删改查食物)
- ✅ 数据统计 (用户活跃度/健康数据统计)
- ✅ 系统设置

**页面结构**:
```
后台 (6个页面):
├── 登录页
├── 仪表盘 (数据概览)
├── 用户管理页
├── 食物管理页
├── 数据统计页
└── 系统设置页
```

## 3. 数据库设计 (精简版)

### 3.1 核心表结构

**1. users (用户表)**
```sql
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    nickname VARCHAR(50),
    phone VARCHAR(20),
    gender ENUM('male', 'female'),
    birth_date DATE,
    height DECIMAL(5,2),
    target_weight DECIMAL(5,2),
    role ENUM('user', 'admin') DEFAULT 'user',
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

**2. health_records (健康记录表)**
```sql
CREATE TABLE health_records (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    record_date DATE NOT NULL,
    weight DECIMAL(5,2),
    exercise_duration INT COMMENT '运动时长(分钟)',
    sleep_hours DECIMAL(4,2),
    notes TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    UNIQUE KEY unique_user_date (user_id, record_date)
);
```

**3. foods (食物数据库表)**
```sql
CREATE TABLE foods (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL,
    category VARCHAR(50) NOT NULL,
    calories_per_100g DECIMAL(8,2) NOT NULL,
    protein_per_100g DECIMAL(6,2) DEFAULT 0,
    fat_per_100g DECIMAL(6,2) DEFAULT 0,
    carbs_per_100g DECIMAL(6,2) DEFAULT 0,
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**4. diet_records (饮食记录表)**
```sql
CREATE TABLE diet_records (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    food_id INT NOT NULL,
    record_date DATE NOT NULL,
    meal_type ENUM('breakfast', 'lunch', 'dinner', 'snack') NOT NULL,
    quantity DECIMAL(8,2) NOT NULL COMMENT '食用量(g)',
    calories DECIMAL(8,2) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,
    FOREIGN KEY (food_id) REFERENCES foods(id) ON DELETE RESTRICT
);
```

## 4. API接口设计

### 4.1 用户相关API
```
POST /api/auth/register      # 用户注册
POST /api/auth/login         # 用户登录
GET  /api/auth/profile       # 获取用户信息
PUT  /api/auth/profile       # 更新用户信息
```

### 4.2 健康记录API
```
POST /api/health            # 创建健康记录
GET  /api/health            # 获取健康记录列表
PUT  /api/health/:id        # 更新健康记录
DELETE /api/health/:id      # 删除健康记录
```

### 4.3 饮食记录API
```
GET  /api/foods             # 获取食物列表
POST /api/diet              # 创建饮食记录
GET  /api/diet              # 获取饮食记录
GET  /api/diet/daily/:date  # 获取某日饮食汇总
```

### 4.4 管理员API
```
GET  /api/admin/users       # 用户管理
POST /api/admin/foods       # 食物管理
GET  /api/admin/stats       # 数据统计
```

## 5. 4周开发计划 (双端并行)

### 第1周: 基础搭建
**Day 1-2: 项目初始化**
- 创建3个项目: 前台(Vant)、后台(Element)、后端(Node.js)
- 配置开发环境和构建工具
- 设置项目基础结构

**Day 3-4: 数据库和后端基础**
- 创建MySQL数据库和表
- 搭建Express基础框架
- 配置JWT认证中间件

**Day 5-7: 基础API开发**
- 用户认证API
- 基础CRUD接口
- API测试

### 第2周: 前台用户端开发
**Day 8-10: Vant前台基础**
- 用户登录/注册页面
- 底部导航栏设置
- 首页布局

**Day 11-12: 健康打卡功能**
- 健康打卡表单 (Vant Form组件)
- 数据提交和验证
- 今日打卡状态显示

**Day 13-14: 饮食记录功能**
- 食物选择列表 (Vant List)
- 三餐记录界面
- 卡路里计算显示

### 第3周: 后台管理端开发
**Day 15-17: Element后台基础**
- 管理员登录页面
- 后台布局框架 (侧边栏+顶栏)
- 仪表盘页面

**Day 18-19: 用户管理功能**
- 用户列表展示 (Element Table)
- 用户信息编辑
- 用户状态管理

**Day 20-21: 食物数据库管理**
- 食物列表管理
- 食物增删改查
- 批量导入功能

### 第4周: 完善和部署
**Day 22-23: 数据统计功能**
- 用户活跃度统计
- 健康数据汇总
- 简单图表展示

**Day 24-25: 前台完善**
- 历史记录页面
- 个人中心页面
- 移动端适配优化

**Day 26-27: 系统集成测试**
- 前后台功能联调
- 接口测试和bug修复
- 性能优化

**Day 28: 部署和文档**
- 本地部署测试
- 编写部署文档
- 项目总结

## 6. 技术实现重点

### 6.1 前台 (Vant) 开发要点
```javascript
// 主要组件使用
- van-form (表单)
- van-list (列表)
- van-picker (选择器)
- van-calendar (日历)
- van-tab (标签页)
- van-button (按钮)
- van-cell (单元格)
```

### 6.2 后台 (Element Plus) 开发要点
```javascript
// 主要组件使用
- el-table (数据表格)
- el-form (表单)
- el-dialog (对话框)
- el-pagination (分页)
- el-menu (菜单)
- el-card (卡片)
- el-date-picker (日期选择)
```

### 6.3 后端开发要点
```javascript
// 核心中间件
- express.json() (JSON解析)
- cors (跨域处理)
- jwt (token验证)
- multer (文件上传，如需要)
```

## 7. 部署方案

### 7.1 开发环境
- 前台: http://localhost:8080
- 后台: http://localhost:8081
- 后端: http://localhost:3000
- 数据库: localhost:3306

### 7.2 生产环境 (可选)
- 使用nginx反向代理
- PM2管理Node.js进程
- MySQL生产配置

## 8. 项目文件结构

```
health-management/
├── frontend-mobile/          # Vant前台
│   ├── src/
│   │   ├── views/            # 页面
│   │   ├── components/       # 组件
│   │   ├── api/             # API接口
│   │   └── router/          # 路由
├── frontend-admin/           # Element后台
│   ├── src/
│   │   ├── views/
│   │   ├── components/
│   │   ├── api/
│   │   └── router/
├── backend/                  # Node.js后端
│   ├── routes/              # 路由
│   ├── models/              # 数据模型
│   ├── middleware/          # 中间件
│   └── utils/               # 工具函数
└── database/                # 数据库文件
    ├── schema.sql           # 表结构
    └── data.sql             # 初始数据
```

这个双端架构既满足了用户移动端使用的便利性，又提供了管理员PC端管理的完整功能，在4周内完全可以实现核心功能。