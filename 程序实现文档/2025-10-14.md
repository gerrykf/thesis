# 后台需求

## 服务端

- 更新用户信息接口报错

```
API请求: PUT /api/admin/users/63
Admin路由收到请求: PUT /api/admin/users/63 -> /users/63
更新用户信息错误: Error: Incorrect date value: '2020-01-31T17:00:00.000Z' for column 'birth_date' at row 1
    at PromisePool.execute (/Users/gerry/LearnSpace/thesis/程序实现文档/backend/health-backend/node_modules/.pnpm/mysql2@3.15.1/node_modules/mysql2/lib/promise/pool.js:54:22)
    at updateUserById (/Users/gerry/LearnSpace/thesis/程序实现文档/backend/health-backend/src/controllers/adminController.ts:714:14)
    at processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'ER_TRUNCATED_WRONG_VALUE',
  errno: 1292,
  sql: 'UPDATE users SET nickname = ?, email = ?, phone = ?, gender = ?, birth_date = ?, height = ?, target_weight = ? WHERE id = ?',
  sqlState: '22007',
  sqlMessage: "Incorrect date value: '2020-01-31T17:00:00.000Z' for column 'birth_date' at row 1"
}
PUT /api/admin/users/63 500 31.361 ms - 51
[2025-10-14T03:06:03.104Z] PUT /api/admin/users/63 500 - 31ms
```

- 删除用户接口报错

```
Admin路由收到请求: DELETE /api/admin/users/63 -> /users/63
删除用户错误: Error: This command is not supported in the prepared statement protocol yet
    at PromisePool.execute (/Users/gerry/LearnSpace/thesis/程序实现文档/backend/health-backend/node_modules/.pnpm/mysql2@3.15.1/node_modules/mysql2/lib/promise/pool.js:54:22)
    at deleteUser (/Users/gerry/LearnSpace/thesis/程序实现文档/backend/health-backend/src/controllers/adminController.ts:803:14)
    at processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'ER_UNSUPPORTED_PS',
  errno: 1295,
  sql: 'START TRANSACTION',
  sqlState: 'HY000',
  sqlMessage: 'This command is not supported in the prepared statement protocol yet'
}
DELETE /api/admin/users/63 500 9.243 ms - 130
[2025-10-14T03:10:06.690Z] DELETE /api/admin/users/63 500 - 10ms
```

- 获取 ById 用户的健康记录接口报错

```
Admin路由收到请求: GET /api/admin/users/63/health-records?page=1&pageSize=10 -> /users/63/health-records
获取用户健康记录错误: Error: Incorrect arguments to mysqld_stmt_execute
    at PromisePool.execute (/Users/gerry/LearnSpace/thesis/程序实现文档/backend/health-backend/node_modules/.pnpm/mysql2@3.15.1/node_modules/mysql2/lib/promise/pool.js:54:22)
    at getUserHealthRecords (/Users/gerry/LearnSpace/thesis/程序实现文档/backend/health-backend/src/controllers/adminController.ts:1016:32)
    at processTicksAndRejections (node:internal/process/task_queues:105:5) {
  code: 'ER_WRONG_ARGUMENTS',
  errno: 1210,
  sql: 'SELECT * FROM health_records WHERE user_id = ? ORDER BY record_date DESC LIMIT ? OFFSET ?',
  sqlState: 'HY000',
  sqlMessage: 'Incorrect arguments to mysqld_stmt_execute'
}
GET /api/admin/users/63/health-records?page=1&pageSize=10 500 21.127 ms - 51
[2025-10-14T03:10:56.161Z] GET /api/admin/users/63/health-records?page=1&pageSize=10 500 - 21ms
```

## 后台管理端

现在分成 用户列表 和 食物列表 两个模块

### 当前

### 用户列表

现在已经开发完成 用户列表 信息读取 解决我上面的接口报错问题

#### 用户详情

- 健康数据统计部分

1. 点击 健康记录 完成显示该用户的完整健康打卡记录
2. 点击 饮食记录 完成显示该用户的完整饮食打卡记录
3. 点击 活跃目标 完成显示该用户的完整目标记录
4. 点击 活跃天数 显示打卡天数
5. 程序实现文档/frontend/health-manage/src/views/user-management/list/index.vue

```
:total="pagination.total"
```

这里总条数显示的 0 但是我接口返回的确实是正确的总条数 但是分页器没有正确显示

6. 用户列表查询条件这里 http://localhost:8848/api/admin/users?page=1&pageSize=20&is_active=false
   根据用户状态查询 false 也没有正确显示
7. 根据用户名查询 数据显示的全部数据 昵称同样 需要调试 这里查询条件

### 食物列表

- 食物列表信息读取
- 食物信息的新增
- 食物信息的修改
- 食物信息的删除
